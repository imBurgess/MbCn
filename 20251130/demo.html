<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DeviceMotion Demo</title>
  <style>
    :root {
      --bg-1: #dfe7f2;
      --bg-2: #c3ddd7;
      --card-bg: rgba(255, 255, 255, 0.9);
      --accent: #00796b;
      --accent-soft: rgba(0, 121, 107, 0.1);
      --text-main: #243b53;
      --text-soft: #627d98;
      --border-subtle: rgba(15, 23, 42, 0.08);
    }

    * ,
    *::before,
    *::after {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px 16px;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      color: var(--text-main);
      background:
        radial-gradient(circle at 0% 0%, #ffffff 0, transparent 50%),
        radial-gradient(circle at 100% 100%, #ffffff 0, transparent 55%),
        linear-gradient(135deg, var(--bg-1), var(--bg-2));
    }

    .app {
      width: min(480px, 100%);
      background: var(--card-bg);
      border-radius: 18px;
      padding: 24px 20px 28px;
      box-shadow:
        0 18px 45px rgba(15, 23, 42, 0.18),
        0 0 0 1px rgba(255, 255, 255, 0.7);
      backdrop-filter: blur(10px);
    }

    h2 {
      margin: 0 0 4px;
      font-size: 1.4rem;
      text-align: center;
      letter-spacing: 0.04em;
    }

    .hint {
      margin: 0 0 16px;
      text-align: center;
      font-size: 0.9rem;
      color: var(--text-soft);
    }

    #btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 10px 18px;
      margin: 0 auto 18px;
      border-radius: 999px;
      border: none;
      background: var(--accent);
      color: #ffffff;
      font-weight: 600;
      font-size: 0.95rem;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      cursor: pointer;
      box-shadow: 0 10px 20px rgba(0, 121, 107, 0.35);
      transition: transform 0.15s ease, box-shadow 0.15s ease,
        background-color 0.15s ease, opacity 0.15s ease;
      display: block;
    }

    #btn:hover:not(:disabled) {
      transform: translateY(-1px);
      box-shadow: 0 14px 26px rgba(0, 121, 107, 0.4);
      background-color: #008b7a;
    }

    #btn:active:not(:disabled) {
      transform: translateY(1px) scale(0.98);
      box-shadow: 0 6px 14px rgba(0, 121, 107, 0.28);
    }

    #btn:disabled {
      cursor: default;
      opacity: 0.65;
      box-shadow: 0 6px 14px rgba(148, 163, 184, 0.45);
      background: #64748b;
    }

    h3 {
      margin: 18px 0 8px;
      font-size: 1rem;
      color: var(--text-main);
      border-left: 3px solid var(--accent);
      padding-left: 8px;
    }

    .val {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      padding: 6px 10px;
      margin: 2px 0;
      border-radius: 10px;
      background: var(--accent-soft);
      border: 1px solid var(--border-subtle);
      font-size: 0.92rem;
      color: var(--text-soft);
    }

    .val span {
      font-family: "SF Mono", "JetBrains Mono", ui-monospace, Menlo, Monaco,
        "Courier New", monospace;
      font-weight: 600;
      color: var(--accent);
      min-width: 70px;
      text-align: right;
    }

    @media (max-width: 480px) {
      body {
        padding: 16px;
      }

      .app {
        padding: 20px 16px 22px;
        border-radius: 14px;
      }

      h2 {
        font-size: 1.2rem;
      }
    }
  </style>
</head>

<body>
  <div class="app">
    <h2>DeviceMotion Demo</h2>
    <p class="hint">請點擊下方按鈕並允許授權，以讀取裝置感測資料。</p>
    <button id="btn">啟用感應器授權</button>

    <h3>DeviceOrientation（方向角度）</h3>
    <p class="val">Alpha (Z)：<span id="alpha">-</span></p>
    <p class="val">Beta (X)：<span id="beta">-</span></p>
    <p class="val">Gamma (Y)：<span id="gamma">-</span></p>

    <h3>DeviceMotion（加速度）</h3>
    <p class="val">ax：<span id="ax">-</span></p>
    <p class="val">ay：<span id="ay">-</span></p>
    <p class="val">az：<span id="az">-</span></p>

    <h3>DeviceMotion（含重力）</h3>
    <p class="val">ax_g：<span id="ax_g">-</span></p>
    <p class="val">ay_g：<span id="ay_g">-</span></p>
    <p class="val">az_g：<span id="az_g">-</span></p>

    <h3>Gyroscope 旋轉速率</h3>
    <p class="val">α（速度）：<span id="rAlpha">-</span></p>
    <p class="val">β（速度）：<span id="rBeta">-</span></p>
    <p class="val">γ（速度）：<span id="rGamma">-</span></p>
  </div>

  <script>
    const btn = document.getElementById("btn");

    //Orientation
    const alphaEl = document.getElementById("alpha");
    const betaEl = document.getElementById("beta");
    const gammaEl = document.getElementById("gamma");

    //Acceration
    const axEl = document.getElementById("ax");
    const ayEl = document.getElementById("ay");
    const azEl = document.getElementById("az");

    //Acceration including gravity
    const axgEl = document.getElementById("ax_g");
    const aygEl = document.getElementById("ay_g");
    const azgEl = document.getElementById("az_g");

    // Rotation rate
    const rAlphaEl = document.getElementById("rAlpha");
    const rBetaEl  = document.getElementById("rBeta");
    const rGammaEl = document.getElementById("rGamma");

    btn.addEventListener("click", async () => {
      try {
        //檢查支援度
        if (!window.DeviceMotionEvent && !window.DeviceOrientationEvent) {
          alert("此裝置不支援感應器")
          return;
        }

        //======== Orientation 授權 ========
        if (typeof DeviceOrientationEvent?.requestPermission === "function") {
          const r1 = await DeviceOrientationEvent.requestPermission();
          if (r1 !== "granted") {
            alert("未允許讀取 DeviceMotion");
            return
          }
        }
        // ======== Motion 授權 ========
        if (typeof DeviceMotionEvent?.requestPermission === "function") {
          const r2 = await DeviceMotionEvent.requestPermission();
          if (r2 !== "granted") {
            alert("未允許讀取 DeviceMotion");
            return;
          }
        }
        // ======== DeviceOrientation Listener ========
        window.addEventListener("deviceorientation", (event) => {
          alphaEl.textContent = event.alpha?.toFixed(2) ?? "-";
          betaEl.textContent  = event.beta?.toFixed(2) ?? "-";
          gammaEl.textContent = event.gamma?.toFixed(2) ?? "-";
        });

        // ======== DeviceMotion Listener ========
        window.addEventListener("devicemotion", (event) => {
          const acc = event.acceleration || {};
          axEl.textContent = acc.x?.toFixed(2) ?? "-";
          ayEl.textContent = acc.y?.toFixed(2) ?? "-";
          azEl.textContent = acc.z?.toFixed(2) ?? "-";

          const accG = event.accelerationIncludingGravity || {};
          axgEl.textContent = accG.x?.toFixed(2) ?? "-";
          aygEl.textContent = accG.y?.toFixed(2) ?? "-";
          azgEl.textContent = accG.z?.toFixed(2) ?? "-";

          const rot = event.rotationRate || {};
          rAlphaEl.textContent = rot.alpha?.toFixed(2) ?? "-";
          rBetaEl.textContent  = rot.beta?.toFixed(2) ?? "-";
          rGammaEl.textContent = rot.gamma?.toFixed(2) ?? "-";
        });

        btn.disabled = true;
        btn.textContent = "感測器已啟動";

      } catch (err) {
        alert("錯誤：" + err);
      }
    });
  </script>
</body>
</html>
